openapi: 3.0.3
info:
  title: FindNest API - Optimized
  description: |
    API t·ªëi ∆∞u cho h·ªá th·ªëng t√¨m ki·∫øm ph√≤ng tr·ªç th√¥ng minh FindNest

    ## 3 Lo·∫°i ng∆∞·ªùi d√πng:

    ### 1. Ng∆∞·ªùi d√πng (Users) - T√¨m ph√≤ng:
    - ƒêƒÉng nh·∫≠p: Phone + OTP (t·ª± ƒë·ªông t·∫°o t√†i kho·∫£n)
    - Quy·ªÅn: Xem danh s√°ch ph√≤ng, t√¨m ki·∫øm, xem chi ti·∫øt, l∆∞u y√™u th√≠ch
    - Li√™n h·ªá: G·ª≠i y√™u c·∫ßu h·ªó tr·ª£, g√≥p √Ω, b√°o l·ªói

    ### 2. Ch·ªß tr·ªç (Landlords) - ƒêƒÉng tin:
    - ƒêƒÉng nh·∫≠p: Phone + OTP, sau ƒë√≥ admin c·∫•p quy·ªÅn landlord
    - Quy·ªÅn: T·∫°o, s·ª≠a, x√≥a tin ƒëƒÉng ph√≤ng tr·ªç, upload h√¨nh ·∫£nh

    ### 3. Qu·∫£n tr·ªã vi√™n (Admins) - Qu·∫£n l√Ω:
    - ƒêƒÉng nh·∫≠p: Username + Password
    - Quy·ªÅn: Qu·∫£n l√Ω to√†n h·ªá th·ªëng, x·ª≠ l√Ω y√™u c·∫ßu h·ªó tr·ª£

    ## T√≠nh nƒÉng ch√≠nh:
    - T√¨m ki·∫øm th√¥ng minh b·∫±ng AI v·ªõi ng√¥n ng·ªØ t·ª± nhi√™n
    - Giao di·ªán b·∫£n ƒë·ªì t∆∞∆°ng t√°c (Google Maps style)
    - L·ªçc theo v·ªã tr√≠ v√† kho·∫£ng c√°ch
    - C√° nh√¢n h√≥a d·ª±a tr√™n favorites v√† profile
    - H·ªá th·ªëng th√¥ng b√°o th√¥ng minh
    - Qu·∫£n l√Ω quy·ªÅn ng∆∞·ªùi d√πng

  version: 3.0.0
  contact:
    name: FindNest Team
    email: admin@findnest.com

servers:
  - url: https://k0qsj9xb67.execute-api.us-east-1.amazonaws.com/prod
    description: Production server
  - url: http://localhost:3001
    description: Local development server

tags:
  - name: Health
    description: Health check endpoints
  - name: Authentication
    description: User authentication and authorization
  - name: Listings
    description: Boarding house listings management
  - name: Profile
    description: User profile management
  - name: Admin
    description: Admin user management
  - name: Favorites
    description: User favorites management
  - name: Images
    description: Image upload and management
  - name: Location
    description: Location services and geocoding
  - name: AI
    description: AI-powered room recommendations
  - name: Support
    description: User support and feedback system
  - name: Notifications
    description: User notifications management
  - name: Landlord
    description: Landlord-specific features and tools
  - name: Analytics
    description: System analytics and reporting

paths:
  /:
    get:
      tags: [Health]
      summary: Swagger UI
      responses:
        "200":
          description: Swagger UI page

  /health:
    get:
      tags: [Health]
      summary: Health check
      responses:
        "200":
          description: API ƒëang ho·∫°t ƒë·ªông
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"

  # ============================================================================
  # AUTHENTICATION ENDPOINTS
  # ============================================================================

  /auth/send-otp:
    post:
      tags: [Authentication]
      summary: G·ª≠i OTP qua SMS (B∆∞·ªõc 1/2)
      description: |
        **Quy tr√¨nh ƒëƒÉng nh·∫≠p/ƒëƒÉng k√Ω b·∫±ng Phone + OTP:**
        1. **B∆∞·ªõc n√†y**: G·ª≠i OTP qua SMS
        2. **B∆∞·ªõc ti·∫øp theo**: G·ªçi `/auth/verify-otp` ƒë·ªÉ x√°c th·ª±c OTP v√† t·ª± ƒë·ªông t·∫°o t√†i kho·∫£n n·∫øu l·∫ßn ƒë·∫ßu
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [phoneNumber]
              properties:
                phoneNumber:
                  type: string
                  description: S·ªë ƒëi·ªán tho·∫°i Vi·ªát Nam (+84xxxxxxxxx ho·∫∑c 0xxxxxxxxx)
                  example: "+84987654321"
      responses:
        "200":
          description: OTP ƒë√£ ƒë∆∞·ª£c g·ª≠i
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "OTP sent successfully. If this is your first time, an account will be created automatically."
                  expiresIn:
                    type: integer
                    description: Th·ªùi gian h·∫øt h·∫°n OTP (gi√¢y)
                    example: 300
                  phoneNumber:
                    type: string
                    example: "+84987654321"
                  otp:
                    type: string
                    description: M√£ OTP 6 ch·ªØ s·ªë (ch·ªâ hi·ªÉn th·ªã khi SNS quota exceeded - s·∫Ω b·ªè khi production)
                    example: "123456"
        "400":
          description: S·ªë ƒëi·ªán tho·∫°i kh√¥ng h·ª£p l·ªá
        "429":
          description: G·ª≠i OTP qu√° nhanh

  /auth/verify-otp:
    post:
      tags: [Authentication]
      summary: X√°c th·ª±c OTP v√† ƒëƒÉng nh·∫≠p/ƒëƒÉng k√Ω (B∆∞·ªõc 2/2)
      description: |
        **Quy tr√¨nh ƒëƒÉng nh·∫≠p/ƒëƒÉng k√Ω b·∫±ng Phone + OTP:**
        1. **B∆∞·ªõc tr∆∞·ªõc**: ƒê√£ g·ªçi `/auth/send-otp` ƒë·ªÉ nh·∫≠n OTP
        2. **B∆∞·ªõc n√†y**: X√°c th·ª±c OTP, t·ª± ƒë·ªông t·∫°o t√†i kho·∫£n n·∫øu l·∫ßn ƒë·∫ßu, v√† nh·∫≠n tokens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [phoneNumber, otp]
              properties:
                phoneNumber:
                  type: string
                  example: "+84987654321"
                otp:
                  type: string
                  pattern: "^[0-9]{6}$"
                  description: M√£ OTP 6 ch·ªØ s·ªë
                  example: "123456"
      responses:
        "200":
          description: X√°c th·ª±c th√†nh c√¥ng
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Welcome! Your account has been created successfully."
                  isNewUser:
                    type: boolean
                    example: true
                  accessToken:
                    type: string
                    description: JWT access token
                  refreshToken:
                    type: string
                    description: JWT refresh token
                  idToken:
                    type: string
                    description: JWT ID token
                  expiresIn:
                    type: integer
                    description: Token expiry time in seconds
                    example: 1800
                  tokenType:
                    type: string
                    example: "Bearer"
                  user:
                    $ref: "#/components/schemas/UserProfile"
        "400":
          description: OTP kh√¥ng ƒë√∫ng ho·∫∑c h·∫øt h·∫°n

  /auth/admin/login:
    post:
      tags: [Authentication]
      summary: ƒêƒÉng nh·∫≠p admin
      description: X√°c th·ª±c admin b·∫±ng username v√† password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [username, password]
              properties:
                username:
                  type: string
                  example: "admin"
                password:
                  type: string
                  example: "Admin@123"
      responses:
        "200":
          description: ƒêƒÉng nh·∫≠p admin th√†nh c√¥ng
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "401":
          description: Th√¥ng tin ƒëƒÉng nh·∫≠p kh√¥ng ƒë√∫ng
        "403":
          description: Kh√¥ng c√≥ quy·ªÅn admin

  /auth/refresh:
    post:
      tags: [Authentication]
      summary: L√†m m·ªõi access token
      description: S·ª≠ d·ª•ng refresh token ƒë·ªÉ l·∫•y access token m·ªõi
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [refreshToken]
              properties:
                refreshToken:
                  type: string
                  description: Refresh token t·ª´ response ƒëƒÉng nh·∫≠p
      responses:
        "200":
          description: Token ƒë√£ ƒë∆∞·ª£c l√†m m·ªõi
        "401":
          description: Refresh token kh√¥ng h·ª£p l·ªá

  /auth/logout:
    post:
      tags: [Authentication]
      summary: ƒêƒÉng xu·∫•t
      description: ƒêƒÉng xu·∫•t v√† v√¥ hi·ªáu h√≥a t·∫•t c·∫£ tokens
      security:
        - bearerAuth: []
      responses:
        "200":
          description: ƒêƒÉng xu·∫•t th√†nh c√¥ng
        "401":
          $ref: "#/components/responses/Unauthorized"

  /auth/me:
    get:
      tags: [Authentication]
      summary: L·∫•y th√¥ng tin user hi·ªán t·∫°i
      description: L·∫•y profile c·ªßa user ƒëang ƒëƒÉng nh·∫≠p
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Th√¥ng tin user
        "401":
          $ref: "#/components/responses/Unauthorized"

  # ============================================================================
  # LISTINGS ENDPOINTS
  # ============================================================================

  /listings:
    get:
      tags: [Listings]
      summary: L·∫•y danh s√°ch ph√≤ng tr·ªç (T√≠ch h·ª£p t·∫•t c·∫£ t√≠nh nƒÉng)
      description: |
        L·∫•y danh s√°ch t·∫•t c·∫£ ph√≤ng tr·ªç v·ªõi kh·∫£ nƒÉng:
        - L·ªçc theo qu·∫≠n/huy·ªán, gi√°, di·ªán t√≠ch, ti·ªán √≠ch
        - T√¨m ki·∫øm theo t√™n
        - L·ªçc theo kho·∫£ng c√°ch t·ª´ v·ªã tr√≠
        - G·ª£i √Ω AI
        - Ch·∫ø ƒë·ªô xem b·∫£n ƒë·ªì

        **Public endpoint** - Kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p
      parameters:
        - name: district
          in: query
          description: L·ªçc theo qu·∫≠n/huy·ªán
          schema:
            type: string
            enum:
              - "Qu·∫≠n 1"
              - "Qu·∫≠n 2"
              - "Qu·∫≠n 3"
              - "Qu·∫≠n 4"
              - "Qu·∫≠n 5"
              - "Qu·∫≠n 6"
              - "Qu·∫≠n 7"
              - "Qu·∫≠n 8"
              - "Qu·∫≠n 9"
              - "Qu·∫≠n 10"
              - "Qu·∫≠n 11"
              - "Qu·∫≠n 12"
              - "Qu·∫≠n B√¨nh Th·∫°nh"
              - "Qu·∫≠n G√≤ V·∫•p"
              - "Qu·∫≠n Ph√∫ Nhu·∫≠n"
              - "Qu·∫≠n T√¢n B√¨nh"
              - "Qu·∫≠n T√¢n Ph√∫"
              - "Qu·∫≠n B√¨nh T√¢n"
              - "Th√†nh ph·ªë Th·ªß ƒê·ª©c"
              - "Huy·ªán H√≥c M√¥n"
              - "Huy·ªán C·ªß Chi"
              - "Huy·ªán B√¨nh Ch√°nh"
              - "Huy·ªán Nh√† B√®"
              - "Huy·ªán C·∫ßn Gi·ªù"
            example: "Qu·∫≠n 1"
        - name: minPrice
          in: query
          description: Gi√° t·ªëi thi·ªÉu (VND)
          schema:
            type: integer
            example: 2000000
        - name: maxPrice
          in: query
          description: Gi√° t·ªëi ƒëa (VND)
          schema:
            type: integer
            example: 5000000
        - name: minArea
          in: query
          description: Di·ªán t√≠ch t·ªëi thi·ªÉu (m¬≤)
          schema:
            type: integer
            example: 20
        - name: search
          in: query
          description: T√¨m ki·∫øm theo t√™n ph√≤ng tr·ªç
          schema:
            type: string
            example: "ph√≤ng ƒë·∫πp"
        - name: amenities
          in: query
          description: L·ªçc theo ti·ªán √≠ch (ph√¢n c√°ch b·∫±ng d·∫•u ph·∫©y)
          schema:
            type: string
            example: "WiFi,ƒêi·ªÅu h√≤a,T·ªß l·∫°nh"
          style: form
          explode: false
        - name: lat
          in: query
          description: Vƒ© ƒë·ªô c·ªßa v·ªã tr√≠ ng∆∞·ªùi d√πng (ƒë·ªÉ l·ªçc theo kho·∫£ng c√°ch)
          schema:
            type: number
            example: 10.7769
        - name: lng
          in: query
          description: Kinh ƒë·ªô c·ªßa v·ªã tr√≠ ng∆∞·ªùi d√πng (ƒë·ªÉ l·ªçc theo kho·∫£ng c√°ch)
          schema:
            type: number
            example: 106.7009
        - name: radius
          in: query
          description: B√°n k√≠nh t√¨m ki·∫øm (km)
          schema:
            type: number
            enum: [1, 2, 5, 10, 15, 20]
            example: 5
        - name: view
          in: query
          description: Ch·∫ø ƒë·ªô xem
          schema:
            type: string
            enum: ["list", "map", "grid"]
            default: "list"
            example: "map"
        - name: recommendations
          in: query
          description: L·∫•y g·ª£i √Ω AI (true/false)
          schema:
            type: string
            enum: ["true", "false"]
            example: "true"
        - name: bounds
          in: query
          description: Gi·ªõi h·∫°n b·∫£n ƒë·ªì cho view=map (lat1,lng1,lat2,lng2)
          schema:
            type: string
            example: "10.7,106.6,10.8,106.8"
      responses:
        "200":
          description: Danh s√°ch ph√≤ng tr·ªç
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Listing"

    post:
      tags: [Listings]
      summary: T·∫°o tin ƒëƒÉng m·ªõi
      description: |
        T·∫°o tin ƒëƒÉng ph√≤ng tr·ªç m·ªõi

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Landlords ho·∫∑c Admins
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateListingRequest"
      responses:
        "201":
          description: T·∫°o tin ƒëƒÉng th√†nh c√¥ng
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "400":
          description: D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Kh√¥ng c√≥ quy·ªÅn t·∫°o tin ƒëƒÉng

  /listings/{listingId}:
    get:
      tags: [Listings]
      summary: L·∫•y chi ti·∫øt ph√≤ng tr·ªç
      description: |
        L·∫•y th√¥ng tin chi ti·∫øt c·ªßa m·ªôt ph√≤ng tr·ªç

        **Public endpoint** - Kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p
      parameters:
        - name: listingId
          in: path
          required: true
          description: ID c·ªßa tin ƒëƒÉng
          schema:
            type: string
            example: "12345678-1234-1234-1234-123456789012"
      responses:
        "200":
          description: Chi ti·∫øt ph√≤ng tr·ªç
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "404":
          description: Kh√¥ng t√¨m th·∫•y tin ƒëƒÉng

    put:
      tags: [Listings]
      summary: C·∫≠p nh·∫≠t tin ƒëƒÉng
      description: |
        C·∫≠p nh·∫≠t th√¥ng tin tin ƒëƒÉng ph√≤ng tr·ªç

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ ch·ªß s·ªü h·ªØu tin ƒëƒÉng ho·∫∑c Admins
      security:
        - bearerAuth: []
      parameters:
        - name: listingId
          in: path
          required: true
          description: ID c·ªßa tin ƒëƒÉng
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateListingRequest"
      responses:
        "200":
          description: C·∫≠p nh·∫≠t th√†nh c√¥ng
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "400":
          description: D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Kh√¥ng c√≥ quy·ªÅn c·∫≠p nh·∫≠t tin ƒëƒÉng n√†y
        "404":
          description: Kh√¥ng t√¨m th·∫•y tin ƒëƒÉng

    delete:
      tags: [Listings]
      summary: X√≥a tin ƒëƒÉng
      description: |
        X√≥a tin ƒëƒÉng ph√≤ng tr·ªç

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ ch·ªß s·ªü h·ªØu tin ƒëƒÉng ho·∫∑c Admins
      security:
        - bearerAuth: []
      parameters:
        - name: listingId
          in: path
          required: true
          description: ID c·ªßa tin ƒëƒÉng
          schema:
            type: string
      responses:
        "204":
          description: X√≥a th√†nh c√¥ng (kh√¥ng c√≥ n·ªôi dung tr·∫£ v·ªÅ)
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Kh√¥ng c√≥ quy·ªÅn x√≥a tin ƒëƒÉng n√†y
        "404":
          description: Kh√¥ng t√¨m th·∫•y tin ƒëƒÉng

  # ============================================================================
  # PROFILE ENDPOINTS
  # ============================================================================

  /profile:
    get:
      tags: [Profile]
      summary: L·∫•y th√¥ng tin c√° nh√¢n
      description: L·∫•y th√¥ng tin profile c·ªßa user hi·ªán t·∫°i
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Th√¥ng tin profile
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: "#/components/schemas/UserProfile"
                  - $ref: "#/components/schemas/LandlordProfile"
                  - $ref: "#/components/schemas/AdminProfile"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: Kh√¥ng t√¨m th·∫•y profile

    put:
      tags: [Profile]
      summary: C·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n
      description: C·∫≠p nh·∫≠t th√¥ng tin profile c·ªßa user hi·ªán t·∫°i
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                fullName:
                  type: string
                  example: "Nguyen Van A"
                phoneNumber:
                  type: string
                  example: "+84987654321"
                businessName:
                  type: string
                  example: "Nha Tro ABC"
                  description: "Ch·ªâ d√†nh cho landlords"
                businessAddress:
                  type: string
                  example: "123 Nguyen Hue, Q1, TPHCM"
                  description: "Ch·ªâ d√†nh cho landlords"
      responses:
        "200":
          description: C·∫≠p nh·∫≠t th√†nh c√¥ng
        "401":
          $ref: "#/components/responses/Unauthorized"

  # ============================================================================
  # FAVORITES ENDPOINTS
  # ============================================================================

  /favorites:
    get:
      tags: [Favorites]
      summary: L·∫•y danh s√°ch y√™u th√≠ch
      description: L·∫•y danh s√°ch c√°c ph√≤ng tr·ªç ƒë√£ l∆∞u y√™u th√≠ch
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Danh s√°ch y√™u th√≠ch
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Favorite"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /favorites/{listingId}:
    post:
      tags: [Favorites]
      summary: Th√™m v√†o y√™u th√≠ch
      description: Th√™m ph√≤ng tr·ªç v√†o danh s√°ch y√™u th√≠ch
      security:
        - bearerAuth: []
      parameters:
        - name: listingId
          in: path
          required: true
          description: ID c·ªßa tin ƒëƒÉng
          schema:
            type: string
            example: "12345678-1234-1234-1234-123456789012"
      responses:
        "201":
          description: ƒê√£ th√™m v√†o y√™u th√≠ch
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Added to favorites"
        "401":
          $ref: "#/components/responses/Unauthorized"

    delete:
      tags: [Favorites]
      summary: X√≥a kh·ªèi y√™u th√≠ch
      description: X√≥a ph√≤ng tr·ªç kh·ªèi danh s√°ch y√™u th√≠ch
      security:
        - bearerAuth: []
      parameters:
        - name: listingId
          in: path
          required: true
          description: ID c·ªßa tin ƒëƒÉng
          schema:
            type: string
            example: "12345678-1234-1234-1234-123456789012"
      responses:
        "200":
          description: ƒê√£ x√≥a kh·ªèi y√™u th√≠ch
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Removed from favorites"
        "401":
          $ref: "#/components/responses/Unauthorized"

  # ============================================================================
  # IMAGES ENDPOINTS
  # ============================================================================

  /images/upload-urls:
    post:
      tags: [Images]
      summary: T·∫°o URL upload cho nhi·ªÅu h√¨nh ·∫£nh
      description: |
        T·∫°o presigned URLs ƒë·ªÉ upload h√¨nh ·∫£nh l√™n S3

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Landlords ho·∫∑c Admins
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [files]
              properties:
                files:
                  type: array
                  maxItems: 10
                  items:
                    type: object
                    required: [fileName, contentType]
                    properties:
                      fileName:
                        type: string
                        example: "room1.jpg"
                      contentType:
                        type: string
                        enum:
                          ["image/jpeg", "image/jpg", "image/png", "image/webp"]
                        example: "image/jpeg"
      responses:
        "200":
          description: URLs upload ƒë√£ ƒë∆∞·ª£c t·∫°o
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  uploads:
                    type: array
                    items:
                      type: object
                      properties:
                        uploadUrl:
                          type: string
                          description: Presigned URL ƒë·ªÉ upload (expires sau 1h)
                          example: "https://s3.amazonaws.com/bucket/key?signature..."
                        key:
                          type: string
                          description: S3 key c·ªßa file
                          example: "listings/userId/uuid-room1.jpg"
                        publicUrl:
                          type: string
                          description: Public URL ƒë·ªÉ truy c·∫≠p sau khi upload
                          example: "https://bucket.s3.region.amazonaws.com/listings/userId/uuid-room1.jpg"
        "400":
          description: D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c qu√° nhi·ªÅu files
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Kh√¥ng c√≥ quy·ªÅn upload

  /images/{key}:
    delete:
      tags: [Images]
      summary: X√≥a h√¨nh ·∫£nh
      description: |
        X√≥a h√¨nh ·∫£nh kh·ªèi S3

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ ch·ªß s·ªü h·ªØu ho·∫∑c Admins
      security:
        - bearerAuth: []
      parameters:
        - name: key
          in: path
          required: true
          description: S3 key c·ªßa h√¨nh ·∫£nh c·∫ßn x√≥a
          schema:
            type: string
            example: "listings/userId/uuid-room1.jpg"
      responses:
        "200":
          description: X√≥a h√¨nh ·∫£nh th√†nh c√¥ng
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Image deleted successfully"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: Kh√¥ng c√≥ quy·ªÅn x√≥a h√¨nh ·∫£nh n√†y
        "500":
          description: L·ªói khi x√≥a h√¨nh ·∫£nh

  # ============================================================================
  # LOCATION ENDPOINTS
  # ============================================================================

  /location/search:
    get:
      tags: [Location]
      summary: T√¨m ki·∫øm ƒë·ªãa ƒëi·ªÉm theo t√™n
      description: |
        T√¨m ki·∫øm ƒë·ªãa ƒëi·ªÉm theo t√™n khu v·ª±c ho·∫∑c ƒë·ªãa ch·ªâ c·ª• th·ªÉ s·ª≠ d·ª•ng Amazon Location Service

        **Public endpoint** - Kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p
      parameters:
        - name: q
          in: query
          required: true
          description: T·ª´ kh√≥a t√¨m ki·∫øm (t√™n khu v·ª±c, ƒë·ªãa ch·ªâ)
          schema:
            type: string
            example: "Qu·∫≠n 1, TP.HCM"
        - name: limit
          in: query
          description: S·ªë l∆∞·ª£ng k·∫øt qu·∫£ t·ªëi ƒëa
          schema:
            type: integer
            default: 10
            example: 10
      responses:
        "200":
          description: Danh s√°ch ƒë·ªãa ƒëi·ªÉm t√¨m ƒë∆∞·ª£c
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  results:
                    type: array
                    items:
                      $ref: "#/components/schemas/PlaceResult"
        "400":
          $ref: "#/components/responses/BadRequest"

  /location/reverse:
    get:
      tags: [Location]
      summary: L·∫•y ƒë·ªãa ch·ªâ t·ª´ t·ªça ƒë·ªô
      description: |
        Chuy·ªÉn ƒë·ªïi t·ªça ƒë·ªô th√†nh ƒë·ªãa ch·ªâ (reverse geocoding)
        
        **L∆∞u √Ω:** Endpoint n√†y tr·∫£ v·ªÅ c·∫•u tr√∫c ƒë∆°n gi·∫£n ƒë·ªÉ hi·ªÉn th·ªã. 
        ƒê·ªÉ l·∫•y c·∫•u tr√∫c ph√π h·ª£p v·ªõi t·∫°o listing, d√πng `/location/search`

        **Public endpoint** - Kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p
      parameters:
        - name: lat
          in: query
          required: true
          description: Vƒ© ƒë·ªô
          schema:
            type: number
            example: 10.7769
        - name: lng
          in: query
          required: true
          description: Kinh ƒë·ªô
          schema:
            type: number
            example: 106.7009
      responses:
        "200":
          description: Th√¥ng tin ƒë·ªãa ch·ªâ (c·∫•u tr√∫c ƒë∆°n gi·∫£n)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  address:
                    $ref: "#/components/schemas/AddressInfo"
        "400":
          $ref: "#/components/responses/BadRequest"

  /location/places/{placeId}:
    get:
      tags: [Location]
      summary: L·∫•y chi ti·∫øt ƒë·ªãa ƒëi·ªÉm
      description: |
        L·∫•y th√¥ng tin chi ti·∫øt c·ªßa m·ªôt ƒë·ªãa ƒëi·ªÉm theo PlaceId

        **Public endpoint** - Kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p
      parameters:
        - name: placeId
          in: path
          required: true
          description: ID c·ªßa ƒë·ªãa ƒëi·ªÉm t·ª´ Amazon Location Service
          schema:
            type: string
            example: "AQIBAHjLzQkSAQAAXwAAACH4mX..."
      responses:
        "200":
          description: Chi ti·∫øt ƒë·ªãa ƒëi·ªÉm
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  place:
                    $ref: "#/components/schemas/PlaceResult"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /location/routes:
    post:
      tags: [Location]
      summary: T√≠nh to√°n tuy·∫øn ƒë∆∞·ªùng gi·ªØa hai ƒëi·ªÉm
      description: |
        T√≠nh to√°n tuy·∫øn ƒë∆∞·ªùng, kho·∫£ng c√°ch v√† th·ªùi gian di chuy·ªÉn gi·ªØa hai ƒëi·ªÉm s·ª≠ d·ª•ng Amazon Location Service

        **Public endpoint** - Kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [origin, destination]
              properties:
                origin:
                  type: array
                  description: T·ªça ƒë·ªô ƒëi·ªÉm xu·∫•t ph√°t [longitude, latitude]
                  items:
                    type: number
                  minItems: 2
                  maxItems: 2
                  example: [106.6903067, 10.8204916]
                destination:
                  type: array
                  description: T·ªça ƒë·ªô ƒëi·ªÉm ƒë·∫øn [longitude, latitude]
                  items:
                    type: number
                  minItems: 2
                  maxItems: 2
                  example: [106.68493, 10.81943]
      responses:
        "200":
          description: Th√¥ng tin tuy·∫øn ƒë∆∞·ªùng
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  route:
                    type: object
                    properties:
                      distance:
                        type: number
                        description: Kho·∫£ng c√°ch (km)
                        example: 1.234
                      duration:
                        type: number
                        description: Th·ªùi gian di chuy·ªÉn (gi√¢y)
                        example: 180
                      geometry:
                        type: object
                        description: H√¨nh h·ªçc tuy·∫øn ƒë∆∞·ªùng (GeoJSON LineString)
                        properties:
                          type:
                            type: string
                            example: "LineString"
                          coordinates:
                            type: array
                            description: M·∫£ng c√°c t·ªça ƒë·ªô [longitude, latitude]
                            items:
                              type: array
                              items:
                                type: number
                            example: [[106.6903067, 10.8204916], [106.69, 10.82], [106.68493, 10.81943]]
                      steps:
                        type: array
                        description: C√°c b∆∞·ªõc trong tuy·∫øn ƒë∆∞·ªùng
                        items:
                          type: object
                          properties:
                            distance:
                              type: number
                              description: Kho·∫£ng c√°ch c·ªßa b∆∞·ªõc n√†y (km)
                              example: 0.234
                            duration:
                              type: number
                              description: Th·ªùi gian c·ªßa b∆∞·ªõc n√†y (gi√¢y)
                              example: 45
                            startPosition:
                              type: array
                              description: T·ªça ƒë·ªô b·∫Øt ƒë·∫ßu [longitude, latitude]
                              items:
                                type: number
                              example: [106.6903067, 10.8204916]
                            endPosition:
                              type: array
                              description: T·ªça ƒë·ªô k·∫øt th√∫c [longitude, latitude]
                              items:
                                type: number
                              example: [106.69, 10.82]
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          description: L·ªói khi t√≠nh to√°n tuy·∫øn ƒë∆∞·ªùng

  # ============================================================================
  # AI ENDPOINTS
  # ============================================================================

  /ai/search:
    post:
      tags: [AI]
      summary: T√¨m ki·∫øm ph√≤ng th√¥ng minh b·∫±ng ng√¥n ng·ªØ t·ª± nhi√™n
      description: |
        ü§ñ **AI-Powered Smart Search** - T√¨m ki·∫øm th√¥ng minh v·ªõi ng√¥n ng·ªØ t·ª± nhi√™n
        
        S·ª≠ d·ª•ng Amazon Bedrock (Claude 3 Sonnet) ƒë·ªÉ:
        - Ph√¢n t√≠ch y√™u c·∫ßu b·∫±ng ti·∫øng Vi·ªát t·ª± nhi√™n
        - Hi·ªÉu ng·ªØ c·∫£nh v√† √Ω nghƒ©a s√¢u xa
        - C√° nh√¢n h√≥a d·ª±a tr√™n favorites v√† profile (n·∫øu ƒë√£ login)
        - Scoring th√¥ng minh d·ª±a tr√™n nhi·ªÅu y·∫øu t·ªë
        
        **V√≠ d·ª• queries:**
        - "Ph√≤ng 2-3 tri·ªáu g·∫ßn tr∆∞·ªùng FPT, y√™n tƒ©nh, c√≥ wifi"
        - "T√¨m ph√≤ng khu an ninh, nhi·ªÅu ch·ªó ƒÉn u·ªëng"
        - "Ph√≤ng thu·∫≠n ti·ªán ƒëi l√†m trung t√¢m"
        
        **Public endpoint** - Kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p (nh∆∞ng c√≥ login s·∫Ω ƒë∆∞·ª£c c√° nh√¢n h√≥a)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [query]
              properties:
                query:
                  type: string
                  description: Y√™u c·∫ßu t√¨m ph√≤ng b·∫±ng ti·∫øng Vi·ªát v·ªõi ng√¥n ng·ªØ t·ª± nhi√™n
                  example: "T√¥i c·∫ßn ph√≤ng g·∫ßn khu an ninh, nhi·ªÅu ch·ªó ƒÉn u·ªëng, thu·∫≠n ti·ªán ƒëi l√†m trung t√¢m"
                userLocation:
                  type: object
                  description: V·ªã tr√≠ hi·ªán t·∫°i c·ªßa ng∆∞·ªùi d√πng (t√πy ch·ªçn)
                  properties:
                    latitude:
                      type: number
                      example: 10.7769
                    longitude:
                      type: number
                      example: 106.7009
      responses:
        "200":
          description: K·∫øt qu·∫£ t√¨m ki·∫øm th√¥ng minh
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  query:
                    type: string
                    example: "T√¥i c·∫ßn t√¨m ph√≤ng tr·ªç d∆∞·ªõi 3 tri·ªáu"
                  parsedRequirements:
                    type: object
                    description: Y√™u c·∫ßu ƒë√£ ƒë∆∞·ª£c AI ph√¢n t√≠ch bao g·ªìm ti√™u ch√≠ ng·ªØ nghƒ©a
                    properties:
                      semanticCriteria:
                        type: object
                        properties:
                          security:
                            type: boolean
                            description: Y√™u c·∫ßu v·ªÅ an ninh
                          foodAndDining:
                            type: boolean
                            description: Y√™u c·∫ßu v·ªÅ ƒÉn u·ªëng
                  explanation:
                    type: string
                    example: "D·ª±a tr√™n y√™u c·∫ßu v·ªÅ khu v·ª±c an ninh v√† nhi·ªÅu ch·ªó ƒÉn u·ªëng, ch√∫ng t√¥i t√¨m th·∫•y c√°c ph√≤ng ph√π h·ª£p..."
                  recommendations:
                    type: array
                    items:
                      allOf:
                        - $ref: "#/components/schemas/Listing"
                        - type: object
                          properties:
                            relevanceScore:
                              type: number
                              example: 85
                            distanceToWork:
                              type: number
                              example: 2.3
                            areaContext:
                              type: object
                              description: Th√¥ng tin ng·ªØ c·∫£nh khu v·ª±c
                              properties:
                                securityScore:
                                  type: number
                                  example: 8
                                restaurantCount:
                                  type: number
                                  example: 15
                  totalFound:
                    type: integer
                    example: 5
        "400":
          $ref: "#/components/responses/BadRequest"



  # ============================================================================
  # SUPPORT ENDPOINTS
  # ============================================================================

  /support:
    post:
      tags: [Support]
      summary: T·∫°o y√™u c·∫ßu h·ªó tr·ª£
      description: |
        T·∫°o y√™u c·∫ßu h·ªó tr·ª£ (y√™u c·∫ßu quy·ªÅn landlord, g√≥p √Ω, b√°o l·ªói, etc.)

        **Y√™u c·∫ßu quy·ªÅn:** Authenticated users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [subject, message]
              properties:
                type:
                  type: string
                  enum:
                    [
                      LANDLORD_REQUEST,
                      FEEDBACK,
                      BUG_REPORT,
                      FEATURE_REQUEST,
                      GENERAL,
                    ]
                  default: GENERAL
                  example: "LANDLORD_REQUEST"
                subject:
                  type: string
                  example: "Y√™u c·∫ßu quy·ªÅn ƒëƒÉng tin"
                message:
                  type: string
                  example: "T√¥i mu·ªën tr·ªü th√†nh ch·ªß tr·ªç ƒë·ªÉ ƒëƒÉng tin cho thu√™ ph√≤ng."
      responses:
        "201":
          description: T·∫°o y√™u c·∫ßu th√†nh c√¥ng
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Support request created successfully"
                  request:
                    $ref: "#/components/schemas/SupportRequest"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

    get:
      tags: [Support]
      summary: L·∫•y danh s√°ch y√™u c·∫ßu h·ªó tr·ª£
      description: |
        L·∫•y t·∫•t c·∫£ y√™u c·∫ßu h·ªó tr·ª£ trong h·ªá th·ªëng

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Danh s√°ch y√™u c·∫ßu h·ªó tr·ª£
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  requests:
                    type: array
                    items:
                      $ref: "#/components/schemas/SupportRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  # ============================================================================
  # NOTIFICATIONS ENDPOINTS
  # ============================================================================

  /notifications:
    get:
      tags: [Notifications]
      summary: L·∫•y danh s√°ch th√¥ng b√°o
      description: |
        L·∫•y t·∫•t c·∫£ th√¥ng b√°o c·ªßa user hi·ªán t·∫°i

        **Y√™u c·∫ßu quy·ªÅn:** Authenticated users
      security:
        - bearerAuth: []
      parameters:
        - name: limit
          in: query
          description: S·ªë l∆∞·ª£ng th√¥ng b√°o t·ªëi ƒëa
          schema:
            type: integer
            default: 20
            example: 20
      responses:
        "200":
          description: Danh s√°ch th√¥ng b√°o
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  notifications:
                    type: array
                    items:
                      type: object
                      properties:
                        notificationId:
                          type: string
                        type:
                          type: string
                          enum: [PRICE_CHANGE, STATUS_CHANGE, LANDLORD_INTEREST, WEEKLY_DIGEST]
                          description: |
                            - PRICE_CHANGE: Th√¥ng b√°o thay ƒë·ªïi gi√° ph√≤ng
                            - STATUS_CHANGE: Th√¥ng b√°o c·∫≠p nh·∫≠t tr·∫°ng th√°i ph√≤ng
                            - LANDLORD_INTEREST: Th√¥ng b√°o c√≥ ng∆∞·ªùi quan t√¢m (cho landlord)
                            - WEEKLY_DIGEST: B·∫£n tin t·ªïng h·ª£p h√†ng tu·∫ßn
                        title:
                          type: string
                        message:
                          type: string
                        metadata:
                          type: object
                        isRead:
                          type: boolean
                        createdAt:
                          type: string
                  unreadCount:
                    type: integer
        "401":
          $ref: "#/components/responses/Unauthorized"

  /notifications/read-all:
    put:
      tags: [Notifications]
      summary: ƒê√°nh d·∫•u t·∫•t c·∫£ ƒë√£ ƒë·ªçc
      description: |
        ƒê√°nh d·∫•u t·∫•t c·∫£ th√¥ng b√°o l√† ƒë√£ ƒë·ªçc

        **Y√™u c·∫ßu quy·ªÅn:** Authenticated users
      security:
        - bearerAuth: []
      responses:
        "200":
          description: ƒê√£ ƒë√°nh d·∫•u t·∫•t c·∫£
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "All notifications marked as read"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /notifications/{notificationId}/read:
    put:
      tags: [Notifications]
      summary: ƒê√°nh d·∫•u ƒë√£ ƒë·ªçc
      description: |
        ƒê√°nh d·∫•u m·ªôt th√¥ng b√°o l√† ƒë√£ ƒë·ªçc

        **Y√™u c·∫ßu quy·ªÅn:** Authenticated users
      security:
        - bearerAuth: []
      parameters:
        - name: notificationId
          in: path
          required: true
          description: ID c·ªßa th√¥ng b√°o
          schema:
            type: string
      responses:
        "200":
          description: ƒê√£ ƒë√°nh d·∫•u
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Notification marked as read"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /support/{requestId}:
    put:
      tags: [Support]
      summary: C·∫≠p nh·∫≠t tr·∫°ng th√°i y√™u c·∫ßu h·ªó tr·ª£
      description: |
        Admin c·∫≠p nh·∫≠t tr·∫°ng th√°i v√† ph·∫£n h·ªìi y√™u c·∫ßu h·ªó tr·ª£

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      parameters:
        - name: requestId
          in: path
          required: true
          description: ID c·ªßa y√™u c·∫ßu h·ªó tr·ª£
          schema:
            type: string
            example: "12345678-1234-1234-1234-123456789012"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status:
                  type: string
                  enum:
                    [
                      PENDING,
                      APPROVED,
                      REJECTED,
                      RECEIVED,
                      IN_PROGRESS,
                      RESOLVED,
                    ]
                  example: "APPROVED"
                adminResponse:
                  type: string
                  example: "Y√™u c·∫ßu ƒë√£ ƒë∆∞·ª£c ph√™ duy·ªát. Quy·ªÅn landlord ƒë√£ ƒë∆∞·ª£c c·∫•p."
      responses:
        "200":
          description: C·∫≠p nh·∫≠t th√†nh c√¥ng
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Support request updated successfully"
                  request:
                    $ref: "#/components/schemas/SupportRequest"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"



  # ============================================================================
  # ADMIN ENDPOINTS
  # ============================================================================

  /admin/users:
    get:
      tags: [Admin]
      summary: L·∫•y danh s√°ch t·∫•t c·∫£ users
      description: |
        L·∫•y danh s√°ch t·∫•t c·∫£ users trong h·ªá th·ªëng v·ªõi ph√¢n trang v√† l·ªçc

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          description: S·ªë trang (b·∫Øt ƒë·∫ßu t·ª´ 1)
          schema:
            type: integer
            default: 1
            example: 1
        - name: limit
          in: query
          description: S·ªë l∆∞·ª£ng users m·ªói trang
          schema:
            type: integer
            default: 20
            example: 20
        - name: userType
          in: query
          description: L·ªçc theo lo·∫°i user
          schema:
            type: string
            enum: [user, landlord, admin]
            example: "user"
        - name: status
          in: query
          description: L·ªçc theo tr·∫°ng th√°i
          schema:
            type: string
            enum: [ENABLED, DISABLED]
            example: "ENABLED"
      responses:
        "200":
          description: Danh s√°ch users
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  users:
                    type: array
                    items:
                      oneOf:
                        - $ref: "#/components/schemas/UserProfile"
                        - $ref: "#/components/schemas/LandlordProfile"
                        - $ref: "#/components/schemas/AdminProfile"
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                        example: 1
                      limit:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 150
                      totalPages:
                        type: integer
                        example: 8
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/stats:
    get:
      tags: [Admin]
      summary: L·∫•y th·ªëng k√™ h·ªá th·ªëng
      description: |
        L·∫•y th·ªëng k√™ t·ªïng s·ªë ng∆∞·ªùi d√πng, ph√≤ng tr·ªç, v√† ph√≤ng ƒëang ho·∫°t ƒë·ªông

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Th·ªëng k√™ h·ªá th·ªëng
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  stats:
                    type: object
                    properties:
                      totalUsers:
                        type: integer
                        description: T·ªïng s·ªë ng∆∞·ªùi d√πng
                        example: 1250
                      totalListings:
                        type: integer
                        description: T·ªïng s·ªë ph√≤ng tr·ªç
                        example: 450
                      activeListings:
                        type: integer
                        description: S·ªë ph√≤ng ƒëang ho·∫°t ƒë·ªông (ch∆∞a h·∫øt h·∫°n)
                        example: 420
                      usersByType:
                        type: object
                        description: Ph√¢n lo·∫°i ng∆∞·ªùi d√πng theo role
                        properties:
                          user:
                            type: integer
                            example: 1000
                          landlord:
                            type: integer
                            example: 200
                          admin:
                            type: integer
                            example: 50
                      systemHealth:
                        type: string
                        description: Tr·∫°ng th√°i h·ªá th·ªëng
                        example: "OK"
                      lastUpdated:
                        type: string
                        format: date-time
                        description: Th·ªùi gian c·∫≠p nh·∫≠t th·ªëng k√™
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/listings/{listingId}:
    delete:
      tags: [Admin]
      summary: X√≥a b√†i ƒëƒÉng vi ph·∫°m
      description: |
        X√≥a c√°c b√†i ƒëƒÉng vi ph·∫°m quy ƒë·ªãnh

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      parameters:
        - name: listingId
          in: path
          required: true
          description: ID c·ªßa tin ƒëƒÉng
          schema:
            type: string
            example: "12345678-1234-1234-1234-123456789012"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [reason]
              properties:
                reason:
                  type: string
                  example: "N·ªôi dung kh√¥ng ph√π h·ª£p, h√¨nh ·∫£nh kh√¥ng li√™n quan"
                  description: "L√Ω do x√≥a b√†i ƒëƒÉng"
      responses:
        "200":
          description: X√≥a b√†i ƒëƒÉng th√†nh c√¥ng
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Listing deleted successfully"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          description: Kh√¥ng t√¨m th·∫•y tin ƒëƒÉng

  /admin/users/{userId}/role:
    put:
      tags: [Admin]
      summary: C·∫≠p nh·∫≠t quy·ªÅn ng∆∞·ªùi d√πng
      description: |
        Qu·∫£n l√Ω quy·ªÅn (role) c·ªßa ng∆∞·ªùi d√πng

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          description: ID c·ªßa user
          schema:
            type: string
            example: "12345678-1234-1234-1234-123456789012"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [role]
              properties:
                role:
                  type: string
                  enum: [user, landlord, admin]
                  example: "landlord"
                  description: "Quy·ªÅn m·ªõi c·ªßa ng∆∞·ªùi d√πng"
      responses:
        "200":
          description: C·∫≠p nh·∫≠t quy·ªÅn th√†nh c√¥ng
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User role updated to landlord"
                  user:
                    type: object
                    description: "Th√¥ng tin user ƒë√£ c·∫≠p nh·∫≠t"
        "400":
          description: Quy·ªÅn kh√¥ng h·ª£p l·ªá
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          description: Kh√¥ng t√¨m th·∫•y user

  /admin/users/{userId}/status:
    put:
      tags: [Admin]
      summary: C·∫≠p nh·∫≠t tr·∫°ng th√°i user
      description: |
        Kh√≥a ho·∫∑c m·ªü kh√≥a t√†i kho·∫£n user

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          description: ID c·ªßa user
          schema:
            type: string
            example: "12345678-1234-1234-1234-123456789012"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status:
                  type: string
                  enum: [ENABLED, DISABLED]
                  example: "DISABLED"
                  description: "ENABLED = m·ªü kh√≥a, DISABLED = kh√≥a t√†i kho·∫£n"
      responses:
        "200":
          description: C·∫≠p nh·∫≠t tr·∫°ng th√°i th√†nh c√¥ng
        "400":
          description: Tr·∫°ng th√°i kh√¥ng h·ª£p l·ªá
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          description: Kh√¥ng t√¨m th·∫•y user



  /admin/system/cleanup-inactive-users:
    post:
      tags: [Admin]
      summary: X√≥a t√†i kho·∫£n kh√¥ng ho·∫°t ƒë·ªông
      description: |
        X√≥a c√°c t√†i kho·∫£n user kh√¥ng ho·∫°t ƒë·ªông qu√° 6 th√°ng (US-010)

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      responses:
        "200":
          description: X√≥a th√†nh c√¥ng
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/system/refresh-area-data:
    post:
      tags: [Admin]
      summary: L√†m m·ªõi d·ªØ li·ªáu khu v·ª±c
      description: |
        L√†m m·ªõi th√¥ng tin ng·ªØ c·∫£nh khu v·ª±c cho c√°c listing (US-040)

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      responses:
        "200":
          description: L√†m m·ªõi th√†nh c√¥ng
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/notifications/send-weekly-digest:
    post:
      tags: [Admin]
      summary: G·ª≠i b·∫£n tin h√†ng tu·∫ßn
      description: |
        G·ª≠i b·∫£n tin t·ªïng h·ª£p h√†ng tu·∫ßn cho ng∆∞·ªùi d√πng (US-050)

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      responses:
        "200":
          description: G·ª≠i th√†nh c√¥ng
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/analytics/popular-areas:
    get:
      tags: [Analytics]
      summary: Th·ªëng k√™ khu v·ª±c ph·ªï bi·∫øn
      description: |
        L·∫•y th·ªëng k√™ c√°c khu v·ª±c ƒë∆∞·ª£c t√¨m ki·∫øm nhi·ªÅu nh·∫•t (US-045)

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      parameters:
        - name: days
          in: query
          description: S·ªë ng√†y th·ªëng k√™
          schema:
            type: integer
            default: 7
      responses:
        "200":
          description: Th·ªëng k√™ khu v·ª±c
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/analytics/users-by-area:
    get:
      tags: [Analytics]
      summary: Th·ªëng k√™ ng∆∞·ªùi d√πng theo khu v·ª±c
      description: |
        Th·ªëng k√™ s·ªë l∆∞·ª£ng ng∆∞·ªùi d√πng theo khu v·ª±c (US-060)

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Admins
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Th·ªëng k√™ ng∆∞·ªùi d√πng
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /landlord/map-data:
    get:
      tags: [Landlord]
      summary: D·ªØ li·ªáu b·∫£n ƒë·ªì cho ch·ªß tr·ªç
      description: |
        L·∫•y d·ªØ li·ªáu th·ªã tr∆∞·ªùng v√† b·∫£n ƒë·ªì cho ch·ªß tr·ªç khi ƒëƒÉng tin (US-042)

        **Y√™u c·∫ßu quy·ªÅn:** Ch·ªâ Landlords ho·∫∑c Admins
      security:
        - bearerAuth: []
      parameters:
        - name: lat
          in: query
          required: true
          description: Vƒ© ƒë·ªô
          schema:
            type: number
        - name: lng
          in: query
          required: true
          description: Kinh ƒë·ªô
          schema:
            type: number
        - name: radius
          in: query
          description: B√°n k√≠nh t√¨m ki·∫øm (km)
          schema:
            type: number
            default: 2
      responses:
        "200":
          description: D·ªØ li·ªáu b·∫£n ƒë·ªì v√† th·ªã tr∆∞·ªùng
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # Enums for data validation
    DistrictEnum:
      type: string
      enum:
        - "Qu·∫≠n 1"
        - "Qu·∫≠n 2"
        - "Qu·∫≠n 3"
        - "Qu·∫≠n 4"
        - "Qu·∫≠n 5"
        - "Qu·∫≠n 6"
        - "Qu·∫≠n 7"
        - "Qu·∫≠n 8"
        - "Qu·∫≠n 9"
        - "Qu·∫≠n 10"
        - "Qu·∫≠n 11"
        - "Qu·∫≠n 12"
        - "Qu·∫≠n B√¨nh Th·∫°nh"
        - "Qu·∫≠n G√≤ V·∫•p"
        - "Qu·∫≠n Ph√∫ Nhu·∫≠n"
        - "Qu·∫≠n T√¢n B√¨nh"
        - "Qu·∫≠n T√¢n Ph√∫"
        - "Qu·∫≠n B√¨nh T√¢n"
        - "Th√†nh ph·ªë Th·ªß ƒê·ª©c"
        - "Huy·ªán H√≥c M√¥n"
        - "Huy·ªán C·ªß Chi"
        - "Huy·ªán B√¨nh Ch√°nh"
        - "Huy·ªán Nh√† B√®"
        - "Huy·ªán C·∫ßn Gi·ªù"

    AmenitiesEnum:
      type: string
      enum:
        - "WiFi"
        - "ƒêi·ªÅu h√≤a"
        - "T·ªß l·∫°nh"
        - "M√°y gi·∫∑t"
        - "B·∫øp ƒëi·ªán"
        - "N√≥ng l·∫°nh"
        - "Ban c√¥ng"
        - "C·ª≠a s·ªï"
        - "Gi∆∞·ªùng"
        - "T·ªß qu·∫ßn √°o"
        - "B√†n gh·∫ø"
        - "Toilet ri√™ng"
        - "B·∫£o v·ªá 24/7"
        - "Thang m√°y"
        - "Ch·ªó ƒë·ªÉ xe"
        - "G·∫ßn ch·ª£"
        - "G·∫ßn tr∆∞·ªùng h·ªçc"
        - "G·∫ßn b·ªánh vi·ªán"
        - "G·∫ßn c√¥ng vi√™n"

    UserTypeEnum:
      type: string
      enum: ["user", "landlord", "admin"]

    UserStatusEnum:
      type: string
      enum: ["ENABLED", "DISABLED"]

    SupportRequestTypeEnum:
      type: string
      enum:
        [
          "LANDLORD_REQUEST",
          "FEEDBACK",
          "BUG_REPORT",
          "FEATURE_REQUEST",
          "GENERAL",
        ]

    SupportRequestStatusEnum:
      type: string
      enum:
        [
          "PENDING",
          "APPROVED",
          "REJECTED",
          "RECEIVED",
          "IN_PROGRESS",
          "RESOLVED",
        ]

    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Operation successful"

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          example: "BadRequest"
        message:
          type: string
          example: "Invalid input data"

    SupportRequest:
      type: object
      properties:
        requestId:
          type: string
          example: "12345678-1234-1234-1234-123456789012"
        userId:
          type: string
          example: "user-12345678-1234-1234-1234-123456789012"
        type:
          type: string
          enum:
            [LANDLORD_REQUEST, FEEDBACK, BUG_REPORT, FEATURE_REQUEST, GENERAL]
          example: "LANDLORD_REQUEST"
        subject:
          type: string
          example: "Y√™u c·∫ßu quy·ªÅn ƒëƒÉng tin"
        message:
          type: string
          example: "T√¥i mu·ªën tr·ªü th√†nh ch·ªß tr·ªç ƒë·ªÉ ƒëƒÉng tin cho thu√™ ph√≤ng."
        status:
          type: string
          enum: [PENDING, APPROVED, REJECTED, RECEIVED, IN_PROGRESS, RESOLVED]
          example: "PENDING"
        adminResponse:
          type: string
          nullable: true
          example: "Y√™u c·∫ßu ƒë√£ ƒë∆∞·ª£c ph√™ duy·ªát."
        createdAt:
          type: string
          format: date-time
          example: "2024-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-15T14:30:00Z"

    AuthResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Authentication successful"
        accessToken:
          type: string
        refreshToken:
          type: string
        idToken:
          type: string
        expiresIn:
          type: integer
          example: 1800
        tokenType:
          type: string
          example: "Bearer"

    UserProfile:
      type: object
      properties:
        userId:
          type: string
          example: "12345678-1234-1234-1234-123456789012"
        userType:
          type: string
          example: "user"
        phoneNumber:
          type: string
          example: "+84987654321"
        fullName:
          type: string
          example: "Nguyen Van A"
        createdAt:
          type: string
          format: date-time
        lastLoginAt:
          type: string
          format: date-time

    LandlordProfile:
      allOf:
        - $ref: "#/components/schemas/UserProfile"
        - type: object
          properties:
            userType:
              type: string
              example: "landlord"
            businessName:
              type: string
              example: "Nha Tro ABC"
            businessAddress:
              type: string
              example: "123 Nguyen Hue, Q1, TPHCM"

    AdminProfile:
      allOf:
        - $ref: "#/components/schemas/UserProfile"
        - type: object
          properties:
            userType:
              type: string
              example: "admin"
            email:
              type: string
              example: "admin@example.com"

    Listing:
      type: object
      properties:
        listingId:
          type: string
          example: "12345678-1234-1234-1234-123456789012"
        title:
          type: string
          example: "Ph√≤ng tr·ªç ƒë·∫πp g·∫ßn trung t√¢m"
        description:
          type: string
          example: "Ph√≤ng tr·ªç s·∫°ch s·∫Ω, ƒë·∫ßy ƒë·ªß ti·ªán nghi"
        price:
          type: number
          example: 3500000
        area:
          type: number
          example: 25
        address:
          type: object
          properties:
            street:
              type: string
              example: "123 Nguyen Hue"
            ward:
              type: string
              example: "Phuong Ben Nghe"
            district:
              type: string
              example: "Quan 1"
            city:
              type: string
              example: "TP.HCM"
        location:
          type: object
          properties:
            latitude:
              type: number
              example: 10.7769
            longitude:
              type: number
              example: 106.7009
        images:
          type: array
          items:
            type: string
            example: "https://bucket.s3.region.amazonaws.com/listings/userId/uuid-room1.jpg"
        amenities:
          type: array
          items:
            type: string
          example: ["WiFi", "ƒêi·ªÅu h√≤a", "T·ªß l·∫°nh"]
        ownerId:
          type: string
          example: "12345678-1234-1234-1234-123456789012"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CreateListingRequest:
      type: object
      required: [title, description, address, location, price, area]
      properties:
        title:
          type: string
          minLength: 10
          maxLength: 100
          example: "Ph√≤ng tr·ªç ƒë·∫πp g·∫ßn trung t√¢m"
        description:
          type: string
          minLength: 20
          maxLength: 1000
          example: "Ph√≤ng tr·ªç s·∫°ch s·∫Ω, ƒë·∫ßy ƒë·ªß ti·ªán nghi"
        price:
          type: number
          minimum: 500000
          maximum: 50000000
          example: 3500000
        area:
          type: number
          minimum: 10
          maximum: 200
          example: 25
        address:
          type: object
          required: [street, ward, district, city]
          properties:
            street:
              type: string
              minLength: 5
              maxLength: 100
              example: "123 Nguyen Hue"
            ward:
              type: string
              minLength: 5
              maxLength: 50
              example: "Phuong Ben Nghe"
            district:
              $ref: "#/components/schemas/DistrictEnum"
              example: "Qu·∫≠n 1"
            city:
              type: string
              enum: ["TP.HCM", "H√† N·ªôi", "ƒê√† N·∫µng", "C·∫ßn Th∆°"]
              example: "TP.HCM"
        location:
          type: object
          required: [latitude, longitude]
          properties:
            latitude:
              type: number
              minimum: 8.0
              maximum: 24.0
              example: 10.7769
            longitude:
              type: number
              minimum: 102.0
              maximum: 110.0
              example: 106.7009
        images:
          type: array
          minItems: 1
          maxItems: 10
          items:
            type: string
            format: uri
          example:
            [
              "https://bucket.s3.region.amazonaws.com/listings/userId/uuid-room1.jpg",
            ]
        amenities:
          type: array
          maxItems: 20
          items:
            $ref: "#/components/schemas/AmenitiesEnum"
          example: ["WiFi", "ƒêi·ªÅu h√≤a", "T·ªß l·∫°nh"]

    UpdateListingRequest:
      type: object
      properties:
        title:
          type: string
          example: "Ph√≤ng tr·ªç ƒë·∫πp g·∫ßn trung t√¢m"
        description:
          type: string
          example: "Ph√≤ng tr·ªç s·∫°ch s·∫Ω, ƒë·∫ßy ƒë·ªß ti·ªán nghi"
        price:
          type: number
          example: 3500000
        area:
          type: number
          example: 25
        images:
          type: array
          items:
            type: string
          example:
            [
              "https://bucket.s3.region.amazonaws.com/listings/userId/uuid-room1.jpg",
            ]
        amenities:
          type: array
          items:
            type: string
          example: ["WiFi", "ƒêi·ªÅu h√≤a", "T·ªß l·∫°nh"]

    Favorite:
      type: object
      properties:
        userId:
          type: string
          example: "12345678-1234-1234-1234-123456789012"
        listingId:
          type: string
          example: "12345678-1234-1234-1234-123456789012"
        createdAt:
          type: string
          format: date-time

    PlaceResult:
      type: object
      properties:
        placeId:
          type: string
          example: "AQIBAHjLzQkSAQAAXwAAACH4mX..."
        label:
          type: string
          example: "Qu·∫≠n 1, TP.HCM"
        address:
          type: object
          properties:
            street:
              type: string
              example: "123 Nguyen Hue"
            ward:
              type: string
              example: "Ph∆∞·ªùng B·∫øn Ngh√©"
            district:
              type: string
              example: "Qu·∫≠n 1"
            city:
              type: string
              example: "Ho Chi Minh City"
        location:
          type: object
          properties:
            latitude:
              type: number
              example: 10.7769
            longitude:
              type: number
              example: 106.7009

    AddressInfo:
      type: object
      properties:
        address:
          type: string
          example: "123 Nguyen Hue"
        ward:
          type: string
          example: "Phuong Ben Nghe"
        district:
          type: string
          example: "Qu·∫≠n 1"
        city:
          type: string
          example: "TP.HCM"
        country:
          type: string
          example: "Vietnam"

  responses:
    BadRequest:
      description: D·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng h·ª£p l·ªá
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Unauthorized:
      description: Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p - c·∫ßn ƒëƒÉng nh·∫≠p
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Forbidden:
      description: Kh√¥ng c√≥ quy·ªÅn th·ª±c hi·ªán h√†nh ƒë·ªông n√†y
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    NotFound:
      description: Kh√¥ng t√¨m th·∫•y t√†i nguy√™n
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
